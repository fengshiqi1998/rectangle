function Rectangle(e,t){var r=Number(e),a=Number(t);this.area=function(){return roundFractional(r*a,2)},this.perimeter=function(){return roundFractional(2*(r+a),2)}}function roundFractional(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function validate(e){var t={isOK:!1,reason:""};return""==e?t.reason="不能为空！":/^-?(0|[1-9]\d*)(\.\d*)?([eE][+-]?\d+)?$/.test(e)?Number(e)<0?t.reason="必须大于零":t.isOK=!0:t.reason="必须是数值",t}function isLegalKey(e,t,r){if(/[a-df-z`~!@#$%^&*()\-=_+[\]{}|;:'",<>/?\\]/i.test(e))return!1;if("."===e){if(0===r||-1!==t.indexOf("."))return!1;if(1===r&&"-"===t.substring(0,1))return!1}if("e"===e||"E"===e){if(0===r||-1!==t.indexOf("e")||-1!==t.indexOf("E"))return!1;if(1===r&&"-"===t.substring(0,1))return!1}return!0}$(function(){var t=$("#width"),r=$("#height"),e=$("#calculate"),a=$("#perimeter"),n=$("#area"),i=$("#width-validate"),u=$("#height-validate"),l=!1;t.focusout(function(){var e=validate(t.val());l=e.isOK,e.isOK?i.html(""):(i.html("宽度"+e.reason),t.select())}),t.keypress(function(e){isLegalKey(e.key,e.target.value,e.target.selectionStart)||e.preventDefault()}),r.focusout(function(){var e=validate(r.val());l=e.isOK,e.isOK?u.html(""):(u.html("高度"+e.reason),r.select())}),r.keypress(function(e){isLegalKey(e.key,e.target.value,e.target.selectionStart)||e.preventDefault()}),e.click(function(){if(l){var e=new Rectangle(t.val(),r.val());a.val(e.perimeter()),n.val(e.area())}})});